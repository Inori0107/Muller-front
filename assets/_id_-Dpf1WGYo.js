import{_ as J,P as M,O as U,r as P,J as W,o as u,c as V,b as t,w as e,i as q,h as i,t as n,R as c,S as X,V as m,e as w,f as r,j as p,d as h,W as b,aq as j,X as I,F as x,k as N,g as z,bd as G,a1 as H,N as K,at as Q,p as Y,l as Z,T as tt}from"./index-D7a5urd6.js";import{c as et,e as at,u as st,b as lt,V as ot}from"./index.esm-Dsc9DITx.js";import{V as T}from"./VContainer-CncUWaTL.js";import{V as _}from"./VRow-CDrr5SkQ.js";import{V as d}from"./VCol-CI_cegoq.js";import{V as rt}from"./VDivider-BBzX8hFq.js";import{V as ct}from"./VSheet-DYzQ3vRA.js";import"./_commonjsHelpers-Cpj98o6Y.js";const B=f=>(Y("data-v-15c4a696"),f=f(),Z(),f),ut={class:"my-4"},nt={class:"mx-1"},dt={class:"my-4"},it={style:{"line-height":"3rem"}},mt=B(()=>i("h1",{class:"text-red"},"已下架",-1)),pt=B(()=>i("div",{class:"category"},"更多商品",-1)),_t={__name:"[id]",setup(f){const{api:k}=tt(),F=H(),$=K(),g=M(),S=U(),o=P({_id:"",name:"",price:0,description:"",image:"",sell:!0,category:"",song:[]});(async()=>{var s,l;try{const{data:a}=await k.get("/product/"+F.params.id);Object.assign(o.value,a.result),document.title="購物網 | "+o.value.name}catch(a){g({text:((l=(s=a==null?void 0:a.response)==null?void 0:s.data)==null?void 0:l.message)||"發生錯誤",snackbarProps:{color:"red"}})}})();const R=async(s,l)=>{if(!S.isLogin){$.push({query:{login:!0}});return}try{const a=await S.addCart_P(s,l);g({text:a.text,snackbarProps:{color:a.color}})}catch{g({text:"加入購物車失敗",snackbarProps:{color:"red"}})}},O=et({quantity:at().typeError("數量必填").required("數量必填").min(1,"最少為 1")}),{isSubmitting:C,handleSubmit:A}=st({validationSchema:O,initialValues:{quantity:1}}),v=lt("quantity"),D=A(async s=>{R(o.value._id,s.quantity)}),y=P([]);(async()=>{var s,l;try{const{data:a}=await k.get("/product",{params:{category:"專輯"}});y.value.splice(0,y.value.length,...a.result.data)}catch(a){g({text:((l=(s=a==null?void 0:a.response)==null?void 0:s.data)==null?void 0:l.message)||"發生錯誤",snackbarProps:{color:"red"}})}})();const E=W(()=>y.value.filter(s=>s._id!==o.value._id));return(s,l)=>(u(),V(x,null,[t(ct,{style:{height:"auto","padding-top":"84px"}},{default:e(()=>[t(T,null,{default:e(()=>[t(_,{justify:"center",align:"center"},{default:e(()=>[t(d,{cols:"9",md:"4",class:"text-center"},{default:e(()=>[t(q,{src:o.value.image,class:"img"},null,8,["src"])]),_:1}),t(d,{cols:"9",md:"5"},{default:e(()=>[t(d,null,{default:e(()=>[i("h1",ut,n(o.value.name),1),i("p",nt,"NT $"+n(o.value.price),1),t(rt,{class:"my-4"}),i("p",dt,n(o.value.description),1)]),_:1}),t(ot,{disabled:c(C),onSubmit:X(c(D),["prevent"])},{default:e(()=>[t(_,{class:"mx-1"},{default:e(()=>[t(m,{variant:"",icon:"",onClick:l[0]||(l[0]=a=>c(v).value.value--)},{default:e(()=>[t(w,null,{default:e(()=>[r("mdi-minus")]),_:1})]),_:1}),t(p),i("span",it,n(c(v).value),1),t(p),t(m,{variant:"",icon:"",onClick:l[1]||(l[1]=a=>c(v).value.value++)},{default:e(()=>[t(w,null,{default:e(()=>[r("mdi-plus")]),_:1})]),_:1}),t(p),t(m,{type:"submit","prepend-icon":"mdi-cart",loading:c(C),flat:"false"},{default:e(()=>[r(" 加入購物車 ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1}),t(_,{justify:"center",class:"mt-8"},{default:e(()=>[o.value.song.length>0?(u(),h(d,{key:0,cols:"9"},{default:e(()=>[t(b,{class:"cool-card"},{default:e(()=>[t(j,{class:"song-title"},{default:e(()=>[r("收錄曲目")]),_:1}),t(I,null,{default:e(()=>[t(_,null,{default:e(()=>[(u(!0),V(x,null,N(o.value.song,(a,L)=>(u(),h(d,{cols:"12",key:L},{default:e(()=>[t(b,{class:"song-card"},{default:e(()=>[t(I,null,{default:e(()=>[r(n(a),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})):z("",!0)]),_:1}),t(G,{class:"align-center justify-center text-center","model-value":!o.value.sell,persistent:""},{default:e(()=>[mt,t(m,{to:"/shop/product"},{default:e(()=>[r("商品列表")]),_:1})]),_:1},8,["model-value"])]),_:1})]),_:1}),t(T,{class:"mt-4 mb-8"},{default:e(()=>[pt,t(_,{class:"mt-8",justify:"center"},{default:e(()=>[(u(!0),V(x,null,N(c(E),a=>(u(),h(d,{cols:"3",key:a._id},{default:e(()=>[t(b,null,{default:e(()=>[t(q,{src:a.image},null,8,["src"]),t(j,{class:"card-title"},{default:e(()=>[r(n(a.name),1)]),_:2},1024),t(Q,null,{default:e(()=>[t(p),t(m,{to:"/shop/products/"+a._id},{default:e(()=>[r("查看詳情")]),_:2},1032,["to"]),t(p)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})],64))}},Ct=J(_t,[["__scopeId","data-v-15c4a696"]]);export{Ct as default};
